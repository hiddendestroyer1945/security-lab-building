# Detecting Live Systems
* **Description**: This document explains the processes used to detect active devices on an organization's network, the tools used in these processes, the associated protocols, and the defensive measures taken to prevent system detection.

* **Introduction**: After gathering information about an organization's domain and its network, this document describes the programs and technologies used to discover network devices, computers, and virtual machines actively running on that network. Additionally, this document also explains the protocols used in these programs and how they work.

* **Port Scanning**: Port scanning is used to discover physical and virtual devices and their associated services on an organization's network. Specifically, it identifies the operating system version and server software configured on active devices. This process helps security experts detect systems running vulnerable software versions that could be exploited.
 
* **IT Security Lab Network Reset**: Verify the functionality of port scanning tools within the IT Security Lab software test platform. If these tools are not operating correctly, configure the necessary ports on network devices (including firewalls) and reconfigure the test platform to ensure proper functionality.

* **Detecting Active Systems**: Port scanning, wardriving, and wardialing are used to discover active devices on an organization's network. While wardriving and wardialing serve as alternatives for device discovery, ICMP is typically used to detect active devices on wireless networks identified through wardriving.
* Port scanning is used to discover active systems via ICMP operations and subsequently identify the services and applications running on those devices.
  * **Wardriving**: Wardialing detects unsecured dial-up modems on a telephone network, whereas wardriving identifies unsecured wireless access points within a specified area. Wardriving can provide unauthorized access to an organization's primary network through unsecured wireless connections.
  * Network firewalls, VPNs, and IDSs are commonly used to protect internal networks. However, an improperly configured wireless access point placed behind a firewall can bypass these protections. Securing wireless networks requires implementing modern encryption protocols and addressing vulnerabilities in legacy algorithms.
    * **Wardriving Protections**: Network firewalls, VPNs, and IDSs are used to protect organization's networks from wireless networks and wardriving processes via wireless networks.
      * **Network Firewalls**: Firewalls are used to protect an organization's users and assets from specific types of network traffic. If you configure a network firewall at the border router of the organization's network or the IT security lab network, you can monitor and filter traffic to protect internal resources, allowing or blocking specific protocols as needed.
      * **VPNs**: A VPN, or Virtual Private Network, is used to route communication over the Internet through a secure channel or tunnel and to encrypt this communication.
      * **IPS**: An intrusion prevention system (IPS) monitors incoming, outgoing, and internal network traffic. It detects and blocks malicious traffic patterns while allowing legitimate communication based on defined security rules.
      * **Encryption**: Encryption can prevent the leakage of data being collected or transmitted.
    * **Wardriving Programs**: This describes programs used to detect and access unsecured wireless networks, either through the organization's wireless network or through the wireless networks of key individuals in the organization, in order to gain access to the organization's network.
      * **Kismet**: This program is used for wardriving to discover wireless networks. To use it, you need a wireless NIC adapter that can monitor wireless network traffic and inject data packets into the wireless network, and a laptop that can connect to it.
      * **Netdiscover**: This program is used for wardriving to discover wireless devices and find the IP range of these wireless devices. To use it, you need a wireless NIC adapter that can monitor wireless network traffic and inject data packets into the wireless network, and a laptop that can connect to it.
      * **Gpsd**: This program is used to perform wardriving to detect GPS devices and discover wireless networks on those GPS devices. That is, it uses `gpsd` to detect GPS devices and uses Kismet to discover wireless networks on those GPS devices. To use it, you need a GlobalSat BU-353-S4 dongle and a laptop that can connect to it.
  * **ICMP**: ICMP, which stands for Internet Control Message Protocol, is a part of the TCP/IP protocol suite. It is used to diagnose problems in networks. ICMP is a network diagnostic protocol that generates and sends error messages to the network to indicate any problems in the network. This explains how it works and what it is designed for.
  * After identifying connected wireless networks, ICMP is used to map out the organization's internal network and identify active physical and virtual devices.
    * **ICMP Restrictions**: Any network device using the TCP/IP suite can process ICMP messages. To prevent "ping flooding" or reconnaissance, administrators should restrict ICMP operations. Common strategies include treating ICMP as normal traffic without priority, rejecting unsolicited ICMP packets, limiting replies to multicast/broadcast requests, or using alternative diagnostic protocols when ICMP is disabled.
    * **Ping & Sweep Programs**: Since the protocol does not specify what data should be in an ICMP packet, ICMP can be used for different purposes and different uses. Different programs are used for this. Additionally, sweep programs are used to ping all IP addresses in the IP address range of the organization's network, one after the other, using ICMP to identify which devices on the organization's network are activated. These two categories of programs are also explained here. 
      * **Ping**: Ping is an ICMP program used to test network connectivity. But, ping is also used to check whether a device at a specific IP address on an organization's network is operational.
      * An ICMP Echo Request is sent to a specified IP address on the organization's network and the device at that specified IP address is identified as operational based on the reply message received.
      * **Fping**: This program is used to ping all the IP addresses on an organization's network one after the other, to identify which devices are running on that network.
      * **Hping3**: This program is used to ping all IP addresses connected to the router found at a specific IP address on the organization's network using ICMP. This allows you to identify which devices are active among the devices connected to that router.
      * **Nmap**: This is a port scanning program. This program is used to ping all IP addresses on an organization's network using ICMP, one after the other. This allows you to determine which devices on the organization's network are activated.
  * **Port Scanning**: Ping and sweep programs are used to discover active physical and virtual devices on an organization's network that does not have ICMP filtering configured. Since firewalls and gateways in such a network typically block ICMP traffic, port scanning programs are required for effective discovery.
  * Port scanning involves connecting a testing computer to the TCP and UDP ports of services and applications to identify what is running on an organization's physical and virtual devices. This activity helps determine the appropriate type of penetration testing to perform on each device.
    * **TCP/IP Basics**: To understand the information available through port scanning of physical and virtual devices on an organization's network and to decide what type of port scanning to perform, you must know the basics of the TCP/IP protocol stack.
    * All devices on a network communicating over TCP/IP support the protocols within the Transmission Control Protocol (TCP) and User Datagram Protocol (UDP) suites. Each unique protocol in the TCP/IP stack was developed for a particular purpose. The IANA [Service Name and Transport Protocol Port Number Registry](https://www.iana.org/assignments/service-names-port-numbers/service-names-port-numbers.xhtml) describes each protocol and the port numbers it uses. A security expert should understand the operation of the most critical and commonly used protocols in the TCP/IP stack.
    * As the Internet grew, the TCP/IP protocol stack evolved to meet its needs. The designers of the early protocols (which operated in a more trusted environment) prioritized flexibility over security, leading to inherent vulnerabilities. While IPv4 remains widely used, networks are migrating to IPv6, which includes native support for security features like IPsec to protect data transmission.
      * **Wireshark**: To examine the workings of protocols in the TCP/IP stack, you can use packet analyzer programs like Wireshark to analyze the encapsulation and structure of network traffic. Therefore, we explain how to configure Wireshark on Debian-based Linux operating systems and how to analyze captured data.
      * During installation on a Debian-based system, select **Yes** when prompted to allow non-superusers to capture packets. This allows your regular user account to perform network analysis without requiring root privileges. Run the following commands to install Wireshark, add your account to the `wireshark` group, and apply the group changes:
        ```bash
        sudo apt update
        sudo apt install -y wireshark
        sudo usermod -aG wireshark $USER
        newgrp wireshark
        ```
      * Once configured, use the following command to identify your active network interface (e.g., `eth0` or `wlan0`):
        ```bash
        ip addr show
        ```
      * Launch Wireshark, select the identified network interface, and begin capturing data packets.
      * While Wireshark is running, it captures network traffic generated by other programs as they communicate across the network. These captured packets are then available for detailed inspection and analysis of the underlying protocols.